name: Hourly Market Analysis

on:
  schedule:
    # Runs every 2 hours between 06:30 and 22:30 Malaysia Time (UTC+8).
    # Converted to UTC: 22:30,00:30,02:30,04:30,06:30,08:30,10:30,12:30,14:30
    - cron: '30 22,0,2,4,6,8,10,12,14 * * *'
  workflow_dispatch:      # Allows manual run button

jobs:
  analyze_market:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install libraries
        run: pip install -r requirements.txt

      - name: Run AI Bot
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python market_bot.py
